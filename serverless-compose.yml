# ============================================================
# ALERTA UTEC - SERVERLESS COMPOSE
# ============================================================

org: ${env:ORG_NAME}
app: alerta-utec-backend
stage: dev

services:
  # Capa compartida con dependencias Python
  dependencias:
    path: Dependencias
    hooks:
      # Hook para crear tablas y poblar datos despu√©s de desplegar dependencias
      after:deploy:finalize: |
        echo "üìä Creando infraestructura y poblando datos..."
        cd DataGenerator
        python3 DataPoblator.py

  # Microservicio de gesti√≥n de usuarios
  usuarios:
    path: Usuarios
    dependsOn:
      - dependencias

  # Microservicio de gesti√≥n de incidentes
  incidentes:
    path: Incidentes
    dependsOn:
      - dependencias
      - usuarios

  # Microservicio de anal√≠tica
  analitica:
    path: Analitica
    dependsOn:
      - dependencias
      - incidentes

